---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Nav from '../../components/Nav.astro';
import Footer from '../../components/Footer.astro';
import SectionScene from '../../islands/SectionScene';
import type { CollectionEntry } from 'astro:content';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
	const projects = await getCollection('projects');
	return projects.map((project) => ({
		params: { slug: project.slug },
		props: { project },
	}));
}

const { project } = Astro.props as { project: CollectionEntry<'projects'> };
const { Content } = await project.render();
const isTerrainProject = project.slug === 'terrain-safety';
const headerVariant = isTerrainProject ? 'terrain' : 'calm';
---

<BaseLayout title={`${project.data.title} | Clawd ML Portfolio`}>
	<Nav />
	<main>
		<section id="project-hero" class="relative min-h-[60vh] overflow-hidden">
			<SectionScene client:only="react" variant={headerVariant} sectionId="project-hero" />
			{isTerrainProject && (
				<div class="pointer-events-none absolute inset-0 z-0 bg-[radial-gradient(circle_at_20%_15%,rgb(var(--color-glow)/0.18),transparent_55%),radial-gradient(circle_at_80%_0%,rgb(var(--color-amber)/0.14),transparent_50%),linear-gradient(to_bottom,rgb(var(--color-ink)/0.35),rgb(var(--color-ink)/0.95))]"></div>
			)}
			<div class="section-shell relative z-10">
				<p class="text-sm text-mist">{project.data.tags.join(' / ')}</p>
				<h1 class="mt-4 text-4xl md:text-5xl">{project.data.title}</h1>
				<p class="mt-4 max-w-2xl text-mist">{project.data.summary}</p>
			</div>
		</section>
		<div class="section-shell prose prose-invert max-w-3xl">
			<Content />
		</div>
	</main>
	<Footer />
</BaseLayout>
